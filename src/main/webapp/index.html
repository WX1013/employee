<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport" />
    <title>职工管理系统</title>
    <link rel="stylesheet" href="./static/common/css/bootstrap.min.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="./static/css/font-awesome.min.css" />
    <!-- Ionicons -->
    <link rel="stylesheet" href="./static/css/ionicons.min.css" />
    <!-- Theme style -->
    <link rel="stylesheet" href="./static/css/AdminLTE.min.css" />


    <link rel="stylesheet" href="./static/css/skin-blue-light.css" />

    <link rel="stylesheet" href="./static/css/skin-blue.css" />

    <link rel="stylesheet" href="./static/css/jedate.css" />

    <link rel="stylesheet" href="./static/css/common.css" />

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="./static/css/bootstrap-table.min.css" />
    <!-- Google Font -->
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic" />

    <link rel="stylesheet" href="./static/css/jquery-confirm.css" />

    <link rel="stylesheet" href="./static/css/ali_iconfont.css" />
</head>
<style>

    .modal-backdrop {
    position: inherit;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: 1040;
    background-color: #000;
    }

    h3,div,p,span,label,button{
        font-family:"微软雅黑"!important;
    }

    @media (min-width: 768px){
        .navbar-nav>li>a {
            padding-top: 23px;
            padding-bottom: 23px;
        }
        .navbar-custom-menu .navbar-nav>li>a {
            padding-top: 15px;
            padding-bottom: 15px;
        }
    }
    @media (max-width: 991px){
        .navbar-nav>li>a {
            padding-top: 15px;
            padding-bottom: 15px;
        }
        .navbar-custom-menu .navbar-nav>li>a {
            padding-top: 23px;
            padding-bottom: 23px;
        }
    }
    .top_logo{
        width:150px;
        margin-top:-15px;
    }
    .top_nav{
        width:100%;
        text-align: center;
        display:inline-block;
    }
    #top_nav_href1, #top_nav_href2, #top_nav_href3{
        padding: 8px 20px;
    }
/*    .padd{
        color:#fff!important;
    }
    .padd img{
        margin-top: 8px!important;
        margin-left: 5px!important;
        float: left!important;
        height:23px;
    }*/
    .Btn1{
        background-color: #f39c12 !important;
        color: #fff!important;
        background-repeat: no-repeat;
        background-size: 22px;
        background-position: 10px;
    }
            .wrapper::-webkit-scrollbar {
        display: none;
    }
    .sidebar-menu::-webkit-scrollbar {
        display: none;
    }
    .wrapper{
    	width:100%;
    	overflow:hidden;
    }
    .sidebar-menu{
    	height: 830px;
    	overflow: auto;
    }
    .sidebar-menu:hover{
    	height: 830px;
    	overflow: auto;
    }
</style>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

    <!-- Main Header -->
    <header class="main-header">

        <!-- Logo -->
        <a href="#" class="logo">
            <span class="logo-mini"><b></b></span>
            <span class="logo-lg"><b>万佛楼</b></span>
        </a>

        <!-- Header Navbar -->
        <nav class="navbar navbar-static-top" role="navigation">
            <ol class="breadcrumb">
            </ol>
            <!-- Navbar Right Menu -->
            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">
                    
                   <li class="dropdown user user-menu" style="top:-6px;">
                        <a href="#" class="dropdown-toggle" style="display: inline;" data-toggle="dropdown" aria-expanded="false">
                            <span class="hidden-xs" id="userName"></span>
                        </a>
                        <ul class="dropdown-menu" style="width: 130%;min-width: 60px;top:33px;">
                            <!-- Menu Footer-->
                            <li class="top_nav"><a style="cursor: pointer;" id="changepassword">修改密码</a></li>
                            <li class="top_nav"><a style="cursor: pointer;" id="outlogin">退出登录</a></li>
                        </ul>
                    </li>
                    
                </ul>
            </div>

        </nav>
        
           <!--新增弹窗-->
			<div class="modal fade" id="passwordModal" tabindex="-1" role="dialog" aria-labelledby="importmodal" data-backdrop="static"  aria-hidden="true">
			    <div class="modal-dialog">
			        <div class="modal-content" >
			            <div class="modal-header">
			            	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			                <h4 class="modal-title">
			                   	 修改密码
			                </h4>
			            </div>
			            <!-- 主体 -->
			            <div class="modal-body">
			                <form id="passwordForm" class="form-horizontal form-inline">
			                    <div class="form-group col-xs-12">
			                        <label class="col-sm-3 control-label">旧密码：</label>
			                        <div class="col-sm-8">
			                            <input id="oldpassword" type="password" maxlength="20" class="form-control" placeholder="请输入旧密码" />
			                        </div>
			                    </div>
			                    <div class="form-group col-xs-12">
			                        <label class="col-sm-3 control-label">新密码：</label>
			                        <div class="col-sm-8">
			                            <input id="newpassword" type="password" maxlength="20" class="form-control" placeholder="请输入新密码" />
			                        </div>
			                    </div>
			                    <div class="form-group col-xs-12">
			                        <label class="col-sm-3 control-label">确认密码：</label>
			                        <div class="col-sm-8">
			                            <input id="againpassword" type="password" maxlength="20" class="form-control" placeholder="请确认密码" />
			                        </div>
			                    </div>
			                </form>
			            </div>
			            <div class="modal-footer" style="margin-top:20px;">
			                <button type="button" class="btn btn-del" data-dismiss="modal">取消
			                </button>
			                <button type="button" class="btn btn-edit padd" onclick="passbutton()">保存
			                </button>
			            </div>
			        </div>
			    </div>
			</div>
    </header>
    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar  ">

        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">

          <!--   <div action="#" method="get" class="sidebar-form">
                <div class="input-group">
                    <input type="text" name="q-sb" class="form-control" placeholder="搜索..." />
                    <span class="input-group-btn">
                <button type="button" name="search" id="search-btn-sb" class="btn btn-flat"><i class="fa fa-search"></i>
                </button>
              </span>
                </div>
            </div>
 -->
            <!-- Sidebar Menu -->
          <ul class="sidebar-menu tree" data-widget="tree" id="sidebar-menu">
            
            <!--   <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>用户管理<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./user/user.htm" class="menu-href li_column2" menu-controller="./user/user.htm" menu-name="用户管理">
                              <i class="  turn-page-click"></i>用户管理</a>
                      </li>
                  </ul>
              </li>


              <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>统计管理<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./statistics/dishesMoney.htm" class="menu-href li_column2" menu-controller="./statistics/dishesMoney.htm" menu-name="销售额">
                              <i class="  turn-page-click"></i>销售额</a>
                      </li>
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./statistics/dishesNum.htm" class="menu-href li_column2" menu-controller="./statistics/dishesNum.htm" menu-name="菜品销量">
                              <i class="  turn-page-click"></i>菜品销量</a>
                      </li>
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./statistics/couponMoney.htm" class="menu-href li_column2" menu-controller="./statistics/couponMoney.htm" menu-name="优惠金额">
                              <i class="  turn-page-click"></i>优惠金额</a>
                      </li>
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./statistics/difClassify.htm" class="menu-href li_column2" menu-controller="./statistics/difClassify.htm" menu-name="不同类型销售额">
                              <i class="  turn-page-click"></i>不同类型销售额</a>
                      </li>
                  </ul>
              </li>
              <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>首页配置<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./banner/banner.htm" class="menu-href li_column2" menu-controller="./banner/banner.htm" menu-name="轮播图管理">
                              <i class="  turn-page-click"></i>轮播图管理</a>
                      </li>
                  </ul>
              </li>

              <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>点餐管理<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./haveMeal/classify.htm" class="menu-href li_column2" menu-controller="./haveMeal/classify.htm" menu-name="菜品分类">
                              <i class="  turn-page-click"></i>菜品分类</a>
                      </li>
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./haveMeal/dishes.htm" class="menu-href li_column2" menu-controller="./haveMeal/dishes.htm" menu-name="菜品详情">
                              <i class="  turn-page-click"></i>菜品详情</a>
                      </li>
                  </ul>
              </li>

              <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>餐桌管理<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./diningTable/diningTable.htm" class="menu-href li_column2" menu-controller="./diningTable/diningTable.htm" menu-name="餐桌管理">
                              <i class="  turn-page-click"></i>餐桌管理</a>
                      </li>
                  </ul>
              </li>
              <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>预约管理<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./reserve/reserveClassify.htm" class="menu-href li_column2" menu-controller="./reserve/reserveClassify.htm" menu-name="分类管理">
                              <i class="  turn-page-click"></i>分类管理</a>
                      </li>
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./reserve/reserve.htm" class="menu-href li_column2" menu-controller="./reserve/reserve.htm" menu-name="预约管理">
                              <i class="  turn-page-click"></i>预约管理</a>
                      </li>
                  </ul>
              </li>
              <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>订单管理<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./order/order.htm" class="menu-href li_column2" menu-controller="./order/order.htm" menu-name="订单管理">
                              <i class="  turn-page-click"></i>订单管理</a>
                      </li>
                  </ul>
              </li>
              <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>用户反馈<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./feedback/feedback.htm" class="menu-href li_column2" menu-controller="./feedback/feedback.htm" menu-name="反馈管理">
                              <i class="  turn-page-click"></i>反馈管理</a>
                      </li>
                  </ul>
              </li>
              <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>系统配置<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./config/config.htm" class="menu-href li_column2" menu-controller="./config/config.htm" menu-name="系统配置">
                              <i class="  turn-page-click"></i>系统配置</a>
                      </li>
                  </ul>
              </li>
               <li class="treeview">
                  <a href="#" menu-controller="" class="li_column">
                      <i class="icon iconfont beamicon-renyuanguanli"></i>权限管理<span></span>
                      <span class="pull-right-container"><i class="fa fa-angle-left pull-right"></i> </span>
                  </a>
                  <ul class="treeview-menu" style="display: none;">
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./role/admindp.htm" class="menu-href li_column2" menu-controller="./role/admindp.htm" menu-name="部门管理">
                              <i class="  turn-page-click"></i>部门管理</a>
                      </li>
                       <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./role/permission.htm" class="menu-href li_column2" menu-controller="./role/permission.htm" menu-name="角色权限">
                              <i class="  turn-page-click"></i>角色权限</a>
                      </li>
                      <li data-flagadd="1" data-flagdel="1" data-flagedit="1" data-flagexport="1" data-flagimport="1">
                          <a href="#./role/adminInfo.htm" class="menu-href li_column2" menu-controller="./role/adminInfo.htm" menu-name="后台用户">
                              <i class="  turn-page-click"></i>后台用户</a>
                      </li>
                  </ul>
              </li> -->

          </ul>
            <!-- /.sidebar-menu -->
        </section>
        <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Main content -->
        <section class="content container-fluid">


        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->

</div>
<!-- ./wrapper -->
<div class="overlay p_loading">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
</div>
<!-- REQUIRED JS SCRIPTS -->

<!-- jQuery 3 -->
<script src="./static/js/jquery.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="./static/js/bootstrap.min.js"></script>
<!-- AdminLTE App -->
<script src="./static/js/adminlte.js"></script>
<!-- handlebars -->
<script src="./static/js/handlebars-v4.0.11.js"></script>
<!-- jquery.jedate -->
<script src="./static/js/jquery.jedate.js"></script>
<!-- Latest compiled and minified JavaScript -->
<script src="./static/js/bootstrap-table.min.js"></script>
<!-- Latest compiled and minified Locales -->
<script src="./static/js/bootstrap-table-zh-CN.min.js"></script>
<script src="./static/js/ajaxfileupload.js"></script>
<script src="./static/js/common.js"></script>
<script src="./static/js/msgbox.js"></script>
<script src="./static/js/bootstrap-treeview.js"></script>
<script src="./static/js/jquery-confirm.js"></script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" src="./static/ossupload/lib/crypto1/crypto/crypto.js"></script>
<script type="text/javascript" src="./static/ossupload/lib/crypto1/hmac/hmac.js"></script>
<script type="text/javascript" src="./static/ossupload/lib/crypto1/sha1/sha1.js"></script>
<script type="text/javascript" src="./static/ossupload/lib/base64.js"></script>
<script type="text/javascript" src="./static/ossupload/lib/plupload-2.1.2/js/plupload.full.min.js"></script>
<script type="text/javascript" src="./static/ossupload/upload.js"></script>
<script type="text/javascript" src="./static/js/date.js"></script>
<script type="text/javascript">
$(function(){
	fetchMenuData();
	var adminname = sessionStorage.getItem("adminname");
	$("#userName").text(adminname);
	 var href = window.location.href;
     if (href.indexOf("#") != -1) {
     	var Request=new UrlSearch(); //实例化
     	var parent = Request.parent;
     	if(parent != ""){
     		parent = decodeURIComponent(parent);
     		var num=href.indexOf("#")
       	   	var str=href.substr(num+1); //取得所有参数   stringvar.substr(start [, length ]
       	    if(typeof(str)!="undefined"){
       	    	loadchild(str);
	       	 	$(".menu-href").each(function(){
	         		if($(this).attr("menu-controller")==parent){
	         			$(this).parent().addClass("active");
	         			if($(this).hasClass("li_column3")){
	                    	$(this).parent().parent().parent().parent().show();
	                        $(this).parent().parent().parent().parent().parent().addClass("menu-open");
	                    }
	         			$(this).parent().parent().show();
	         			$(this).parent().parent().parent().addClass("menu-open");
	         		}
	         	})
       	    }
     	}else{
     		var url = href.split("#")[1];
     		console.log(url);
     		if(url != ""){
     			loadchild(url);
     			$(".menu-href").each(function(){
	         		if($(this).attr("menu-controller")==url){
	         			$(this).parent().addClass("active");
	         			if($(this).hasClass("li_column3")){
	                    	$(this).parent().parent().parent().parent().show();
	                        $(this).parent().parent().parent().parent().parent().addClass("menu-open");
	                    }
	         			$(this).parent().parent().show();
	         			$(this).parent().parent().parent().addClass("menu-open");
	         		}
	         	})
     		}
     	}
     }

});
$(window).on('popstate', function () {
    var href = window.location.href;
    var Request=new UrlSearch(); //实例化
    if (href.indexOf("#") != -1) {
        var Request=new UrlSearch(); //实例化
        var parent = Request.parent;
        if(typeof(parent)!="undefined"){
            var num=href.indexOf("#")
            var str=href.substr(num+1); //取得所有参数   stringvar.substr(start [, length ]
            loadchild(str);
            $(".menu-href").each(function(){
                if($(this).attr("menu-controller")==parent){
                    $(this).parent().addClass("active");
                    if($(this).hasClass("li_column3")){
                    	$(this).parent().parent().parent().parent().show();
                        $(this).parent().parent().parent().parent().parent().addClass("menu-open");
                    }
                    $(this).parent().parent().show();
                    $(this).parent().parent().parent().addClass("menu-open");
                }
            })
        }else{
            var url = href.split("#")[1];
            $(".menu-href").each(function(){
                if($(this).attr("menu-controller")==url){
                    $(this).click();
                    if($(this).hasClass("li_column3")){
                    	$(this).parent().parent().parent().parent().show();
                        $(this).parent().parent().parent().parent().parent().addClass("menu-open");
                    }
                    $(this).parent().parent().show();
                    $(this).parent().parent().parent().addClass("menu-open");
                }
            })
        }
    }
});

$('#search-btn-sb').click(function () {
    var search = $('input[name=q-sb]').val();
    if(!search){
        return ;
    }
    $(".menu-href").each(function(i){
        if($(this).attr("menu-name").indexOf(search) != -1){
        	$("li").removeClass("active");
        	$("li").removeClass("menu-open");
        	$(".treeview-menu").hide();
            loadchild($(this).attr('menu-controller'));
            $(this).parent().addClass("active");
            if($(this).hasClass("li_column3")){
            	$(this).parent().parent().parent().parent().show();
                $(this).parent().parent().parent().parent().parent().addClass("menu-open");
            }
           	$(this).parent().parent().show();
            $(this).parent().parent().parent().addClass("menu-open");
        }
    })
})
$('input[name=q-sb]').bind('keypress',function(event){
    if(event.keyCode == 13) {
        $('#search-btn-sb').click();
    }
});

$("#changepassword").click(function(){
	$("#oldpassword").val("");
	$("#newpassword").val("");
	$("#againpassword").val("");
	$("#passwordModal").modal("show");
	$(".modal-backdrop").css("display","none");
});

$("#outlogin").click(function(){
	$.ajax({
		url : './admin/outlogin',
		type:"GET",
        beforeSend:function (xmlReq) {
       	 $('.overlay').css('display','block');
       },
		success : function(){
			$('.overlay').hide();
			location.replace("./login");
		}
	});
});

function passbutton(){
	
	var oldpassword = $("#oldpassword").val();
	var newpassword = $("#newpassword").val();
	var againpassword = $("#againpassword").val();
	if(!oldpassword){
		alert("请输入旧密码");
		return;
	}
	if(!newpassword){
		alert("请输入新密码");
		return;
	}
	if(!againpassword){
		alert("请确认密码");
		return;
	}
	if(newpassword != againpassword){
		alert("两次新密码输入不一致");
		return;
	}
	debugger;
	$.ajax({
		url : './admin/changepassword',
		data:{"oldpassword":oldpassword,"newpassword":newpassword},
        async: false,
        type:"POST",
        beforeSend:function (xmlReq) {
       	 $('.overlay').css('display','block');
       },
       success : function(result){
    	   $('.overlay').hide();
    	   if(result.code==300){
    		   alert(result.message);
    		   return;
    	   }else if(result.code == 200){
    		   alert(result.message);
    		   location.replace("./login");
    	   }else{
    		   alert(result.message);
    	   }
       }
	});
}
</script>
</body>
</html>
